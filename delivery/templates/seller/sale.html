{% extends "layout.html" %}
{% load static %}


{% block body %}
<div class="container">
    <div class="row d-flex justify-content-center">
        <div class="col-xm-12 col-sm-10 col-md-8 col-lg-6">
            <a href="{% url 'my_sales' %}" class="btn btn-dark rounded-pill">
                <i class="bi bi-arrow-left"></i>
                <span>My sales</span>
            </a>
            <div class="d-flex justify-content-between">
                <h3 class="p-3">Order <span>{{ order.id }}</span></h3>
                <h3 class="p-3">Total: <span name="price">{{ order.total_price }}</span></h3>
            </div>
            <ul class="list-group">
                {% for item in items %}
                    <a href="{% url 'product' product_id=item.product.id %}" class="list-group-item glass border-0 rounded-3 text-light d-flex align-items-center mb-3 link-underline link-underline-opacity-0">
                        <span class="d-flex justify-content-center align-items-center h-100 square p-1">
                            {% if item.product.image_url != "" %}
                                <img name="product-image" src="{{ item.product.image_url }}" class="full-glass w-100 rounded-2">
                            {% else %}
                                <img name="product-image" src="{% static 'icon.png' %}" class="glass rounded-2">
                            {% endif %}
                        </span>
                        <div class="d-flex p-4 px-2 flex-column col-9">
                            <h4>{{ item.product }}</h4>
                            <p>{{ item.quant }}&times;&nbsp;<span name="price">{{ item.product.price }}</span></p>
                        </div>
                    </a>
                {% endfor %}
            </ul>
            <div class="d-flex flex-column align-items-center m-4">
                <p>Current status: {{ order.status.description }}</p>
                <div action="" class="d-flex flex-column">
                    {% if order.status.description == "Processing" %}
                        <a href="{% url 'update_order_status' status_id=2 order_id=order.id %}" class="btn btn-theme my-3">Confirm order</a>
                        <a class="btn bg-black text-light" data-bs-toggle="modal" data-bs-target="#exampleModal">Reject order</a>
                        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content d-flex flex-column align-items-center bg-dark p-4">
                                    <p>Reject an order can reduce your seller reputation. Are you sure you want to proceed?</p>
                                    <span>
                                        <button type="button" class="btn btn-theme" data-bs-dismiss="modal">No, keep order</button>
                                        <a type="button" class="btn btn-secondary">Yes, reject order</a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    {% elif order.status.description == "In preparation" %}
                        <a href="{% url 'update_order_status' status_id=3 order_id=order.id %}" class="btn btn-theme">Ready for pickup</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'seller/sale.js' %}"></script>
<script src="{% static 'productList.js' %}"></script>
{% endblock %}